<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Resumo Geral - Liga de Guerra</title>
    <style>
        body {
            font-family: sans-serif;
            background-color: #111;
            color: #fff;
            margin: 0;
            display: flex;
            height: 100vh;
        }

        .sidebar {
            width: 200px;
            background-color: #000;
            padding: 20px;
            box-sizing: border-box;
        }

            .sidebar h2 {
                color: #0ff;
                margin-top: 0;
            }

            .sidebar a {
                color: #0ff;
                text-decoration: none;
                display: block;
                margin: 10px 0;
            }

        .dropdown-content {
            margin-left: 10px;
        }

        .content {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }

        .groupbox {
            background-color: #222;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

            .groupbox h3 {
                margin-top: 0;
                color: #0ff;
            }

        ul {
            list-style: none;
            padding-left: 0;
        }

        li {
            padding: 4px 0;
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <h2>TEAM ZIGG</h2>
        <a href="/">Início</a>
        <a href="/membros.html">Membros</a>
        <div class="dropdown-content">
            <a href="/resumo.html">Resumo Geral</a>
            <a href="/guerra1.html">Estatísticas Guerra 1</a>
            <a href="/guerra2.html">Estatísticas Guerra 2</a>
            <a href="/guerra3.html">Estatísticas Guerra 3</a>
            <a href="/guerra4.html">Estatísticas Guerra 4</a>
            <a href="/guerra5.html">Estatísticas Guerra 5</a>
            <a href="/guerra6.html">Estatísticas Guerra 6</a>
            <a href="/guerra7.html">Estatísticas Guerra 7</a>
            <a href="/guerra8.html">Estatísticas Guerra 8</a>
        </div>
    </div>

    <div class="content">
        <h1>Resumo Geral</h1>

        <div class="groupbox" id="estrelas-box">
            <h3>Estrelas por Jogador</h3>
            <ul id="estrelas-list"></ul>
        </div>

        <div class="groupbox" id="faltantes-box">
            <h3>Jogadores que não atacaram</h3>
            <ul id="faltantes-list"></ul>
        </div>
    </div>

    <script>
    fetch('https://team-zigg-api.onrender.com/currentwar')
      .then(res => res.json())
      .then(data => {
        if (!data || !data.members || !data.attacks) {
          console.error('Dados da guerra não encontrados');
          return;
        }

        const estrelasPorJogador = {};
        const ataquesFeitos = {};

        data.attacks.forEach(ataque => {
          const nome = ataque.attackerTag;
          estrelasPorJogador[nome] = (estrelasPorJogador[nome] || 0) + ataque.stars;
          ataquesFeitos[nome] = (ataquesFeitos[nome] || 0) + 1;
        });

        const membros = data.members;
        const listaEstrelas = [];
        const listaFaltantes = [];

        membros.forEach(member => {
          const nome = member.name;
          const tag = member.tag;
          const estrelas = estrelasPorJogador[tag] || 0;
          const ataques = ataquesFeitos[tag] || 0;

          listaEstrelas.push({ nome, estrelas });

          if (ataques === 0) {
            listaFaltantes.push(nome);
          }
        });

        listaEstrelas.sort((a, b) => b.estrelas - a.estrelas);

        const estrelasList = document.getElementById("estrelas-list");
        listaEstrelas.forEach(jogador => {
          const li = document.createElement("li");
          li.textContent = `${jogador.nome} - ${jogador.estrelas} estrelas`;
          estrelasList.appendChild(li);
        });

        const faltantesList = document.getElementById("faltantes-list");
        listaFaltantes.forEach(nome => {
          const li = document.createElement("li");
          li.textContent = nome;
          faltantesList.appendChild(li);
        });
      })
      .catch(err => console.error('Erro ao carregar dados da guerra:', err));
    </script>
</body>
</html>
